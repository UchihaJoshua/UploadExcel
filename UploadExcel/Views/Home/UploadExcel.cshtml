@* @{ *@
@*     ViewData["Title"] = "Upload Excel"; *@
@* } *@

@* <div class="container my-5"> *@
@*     <!-- Notification Alerts --> *@
@*     @if (!string.IsNullOrEmpty(ViewBag.Message) && ViewBag.Message == "success") *@
@*     { *@
@*         <div class="alert alert-success alert-dismissible fade show" role="alert"> *@
@*             <strong>Success!</strong> All records inserted successfully. *@
@*             <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> *@
@*         </div> *@
@*     } *@
@*     else if (!string.IsNullOrEmpty(ViewBag.Message) && ViewBag.Message == "empty") *@
@*     { *@
@*         <div class="alert alert-warning alert-dismissible fade show" role="alert"> *@
@*             <strong>Warning!</strong> The file is empty. *@
@*             <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> *@
@*         </div> *@
@*     } *@

@*     <!-- Form Section --> *@
@*     <div class="card shadow-lg"> *@
@*         <div class="card-body p-4"> *@
@*             <h2 class="text-center mb-4">Upload Excel File</h2> *@
@*             <form method="post" enctype="multipart/form-data"> *@
@*                 <div class="mb-4"> *@
@*                     <label for="file" class="form-label">Select Excel File</label> *@
@*                     <input type="file" name="file" id="file" class="form-control" /> *@
@*                 </div> *@

@*                 <div class="d-flex justify-content-center"> *@
@*                     <button type="submit" class="btn btn-dark btn-lg px-4">Upload Excel File</button> *@
@*                 </div> *@
@*             </form> *@
@*         </div> *@
@*     </div> *@
@* </div> *@


@{
    ViewData["Title"] = "Upload Excel";
}

<!-- External CSS for modern styling (optional if you're using a CDN) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

<h2 class="text-center my-4">Upload Excel</h2>

<div class="container">
    <form method="post" enctype="multipart/form-data" class="bg-light p-4 rounded shadow-sm">

        <!-- Dropdown to select the table -->
        <div class="mb-3">
            <label for="selectedTable" class="form-label">Select Table:</label>
            <select id="selectedTable" name="selectedTable" class="form-select">
                <option value="">--Select Table--</option>
                @foreach (var tableName in ViewBag.TableNames as List<string>)
                {
                    var isSelected = ViewBag.SelectedTable == tableName;
                    <option value="@tableName" selected="@isSelected">@tableName</option>
                }
            </select>
        </div>

        <!-- Show Table Columns only when a table is selected -->
        @if (ViewBag.TableColumns != null && ViewBag.SelectedTable != null)
        {
            <div class="mb-3">
                <h5>Table Columns:</h5>
                <ul class="list-group">
                    @foreach (var column in ViewBag.TableColumns as List<string>)
                    {
                        <li class="list-group-item">@column</li>
                    }
                </ul>
            </div>
        }

        <!-- File input to upload the Excel file -->
        <div class="mb-3">
            <label for="file" class="form-label">Choose Excel File:</label>
            <input type="file" name="file" id="file" class="form-control" required />
        </div>

        <!-- Submit button to upload the file -->
        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary">Upload</button>
        </div>
    </form>

    <!-- Display message after upload attempt -->
    @if (!string.IsNullOrEmpty(ViewBag.Message))
    {
        <div class="alert alert-info mt-4">@ViewBag.Message</div>
    }
</div>

<!-- External JS for Bootstrap (optional if you're using a CDN) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>











